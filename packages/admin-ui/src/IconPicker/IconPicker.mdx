import { Canvas, Meta, Controls } from '@storybook/blocks';

import * as IconPickerStories from './IconPicker.stories';

<Meta of={IconPickerStories} />

# Icon Picker

The Icon Picker component allows users to select icons from a predefined set of options. It provides an intuitive interface for icon selection in forms and design tools, with search functionality to quickly find specific icons.

## Usage

```tsx
import React, { useState } from "react";
import { IconPicker } from "@webiny/admin-ui";
import { library } from "@fortawesome/fontawesome-svg-core";
import { fas } from "@fortawesome/free-solid-svg-icons";

// Initialize FontAwesome library
library.add(fas as any);

const IconPickerExample = () => {
    const [selectedIcon, setSelectedIcon] = useState("");
    const [validation, setValidation] = useState({ isValid: true, message: "" });

    const handleChange = (newIcon: string) => {
        setSelectedIcon(newIcon);

        if (!newIcon && true) { // true represents required field
            setValidation({ isValid: false, message: "Please select an icon" });
        } else {
            setValidation({ isValid: true, message: "" });
        }
    };

    return (
        <IconPicker
            label="Select an Icon"
            description="Choose an icon for your button"
            note="Note: The selected icon will be displayed on your button"
            required={true}
            icons={[
                { prefix: "fas", name: "trash-restore-alt" },
                { prefix: "fas", name: "file-pen" },
                { prefix: "fas", name: "receipt" },
                { prefix: "fas", name: "user-circle" },
                { prefix: "fas", name: "circle-user" }
                // Add more icons as needed
            ]}
            value={selectedIcon}
            onChange={handleChange}
            validation={validation}
        />
    );
};

export default IconPickerExample;
```

<Canvas of={IconPickerStories.Documentation} source={ { code: `
import React, { useState } from "react";
import { IconPicker } from "@webiny/admin-ui";
import { library } from "@fortawesome/fontawesome-svg-core";
import { fas } from "@fortawesome/free-solid-svg-icons";

// Initialize FontAwesome library
library.add(fas as any);

const IconPickerExample = () => {
    const [selectedIcon, setSelectedIcon] = useState("");
    const [validation, setValidation] = useState({ isValid: true, message: "" });

    const handleChange = (newIcon: string) => {
        setSelectedIcon(newIcon);

        if (!newIcon && true) { // true represents required field
            setValidation({ isValid: false, message: "Please select an icon" });
        } else {
            setValidation({ isValid: true, message: "" });
        }
    };

    return (
        <IconPicker
            label="Select an Icon"
            description="Choose an icon for your button"
            note="Note: The selected icon will be displayed on your button"
            required={true}
            icons={[
                { prefix: "fas", name: "trash-restore-alt" },
                { prefix: "fas", name: "file-pen" },
                { prefix: "fas", name: "receipt" },
                { prefix: "fas", name: "user-circle" },
                { prefix: "fas", name: "circle-user" }
                // Add more icons as needed
            ]}
            value={selectedIcon}
            onChange={handleChange}
            validation={validation}
        />
    );
};

export default IconPickerExample;
` } }
        additionalActions={[
            {
                title: 'Open in GitHub',
                onClick: () => {
                    window.open(
                        'https://github.com/webiny/webiny-js/blob/feat/new-admin-ui/packages/admin-ui/src/IconPicker/IconPicker.tsx',
                        '_blank'
                    );
                },
            }
        ]}
/>

<Controls of={IconPickerStories.Documentation} exclude={"onChange"} />

## Dynamic Loading All Font Awesome Icons

> ⚠️ **Note**: Importing all icons will increase your bundle size. Use this approach only when necessary, or pair it with a search interface to maintain a good user experience.

To automatically load all Font Awesome icons (solid, regular, and brands) for use in the `IconPicker`, you can register them with the Font Awesome library and extract them from the internal `definitions` object. This approach provides a scalable and maintainable way to manage icon sets across your application.

```tsx
import React, { useState } from "react";
import { IconPicker, IconPickerIconDto } from "@webiny/admin-ui";
import { library, IconName } from "@fortawesome/fontawesome-svg-core";
import { fas } from "@fortawesome/free-solid-svg-icons";
import { far } from "@fortawesome/free-regular-svg-icons";
import { fab } from "@fortawesome/free-brands-svg-icons";
import { IconPrefix } from "@fortawesome/fontawesome-common-types";

// Register all Font Awesome icons
// Initialize FontAwesome library
library.add(fab as any, fas as any, far as any);

// Define allowed prefixes
const validPrefixes: IconPrefix[] = ["fas", "far", "fab"];

// Extract icons into { prefix, name } format
const definitions = (library as any).definitions;
const allIcons: IconPickerIconDto[] = [];

Object.keys(definitions)
    .filter((pack): pack is IconPrefix => validPrefixes.includes(pack as IconPrefix))
    .forEach((prefix) => {
        const icons = definitions[prefix];
        Object.keys(icons).forEach((icon) => {
            allIcons.push({
                prefix,
                name: icon as IconName
            });
        });
    });
```

You can then pass the `allIcons` array to the `IconPicker` component:

```tsx
<IconPicker
    label="Select an Icon"
    description="Choose an icon for your button"
    note="Note: The selected icon will be displayed on your button"
    required={true}
    icons={allIcons}
    value={selectedIcon}
    onChange={handleChange}
    validation={validation}
/>
```

## Anatomy

### Icon Picker Anatomy

The Icon Picker component consists of several key parts:

1. **Label**: Identifies the purpose of the icon picker
2. **Icon Preview**: Shows the currently selected icon
3. **Icon Grid**: Displays available icons for selection
4. **Search Input**: Allows filtering icons by name
5. **Validation Message**: Displays error messages when validation fails
6. **Description**: Provides additional context or instructions
7. **Note**: Additional information or guidance for the user

### Features

- **Icon Grid Display**: Visual representation of available icons
- **Search Functionality**: Quick filtering of icons by name
- **Icon Preview**: Visual representation of the selected icon
- **Categorization**: Icons can be grouped by category
- **Validation**: Built-in support for validation with error messages
- **Accessibility**: Keyboard navigation and screen reader support



## Best Practices

1. **Provide a meaningful label**: Make it clear what the icon will be used for
2. **Limit icon choices**: When possible, limit the number of icons to those relevant to the context
3. **Group related icons**: Organize icons by category for easier selection
4. **Include search functionality**: Allow users to search for icons by name
5. **Show icon preview**: Always display the currently selected icon clearly
6. **Provide context**: Use descriptions to explain how the icon will be used
7. **Consider accessibility**: Ensure icons have proper labels for screen readers