# This file was automatically generated by github-actions-wac.
# DO NOT MODIFY IT BY HAND. Instead, modify the source *.wac.ts file(s)
# and run "github-actions-wac build" (or "ghawac build") to regenerate this file.
# For more information, run "github-actions-wac --help".
name: Pull Requests Command - Jest
'on': issue_comment
env:
  NODE_OPTIONS: '--max_old_space_size=4096'
  AWS_REGION: eu-central-1
jobs:
  checkComment:
    name: Check comment for /jest
    if: ${{ github.event.issue.pull_request }}
    steps:
      - uses: actions/setup-node@v4
        with:
          node-version: 22
      - name: Check for Command
        id: command
        uses: xt0rted/slash-command-action@v2
        with:
          repo-token: ${{ secrets.GITHUB_TOKEN }}
          command: jest
          reaction: 'true'
          reaction-type: eyes
          allow-edits: 'false'
          permission-level: write
      - name: Create comment
        uses: peter-evans/create-or-update-comment@v2
        with:
          issue-number: ${{ github.event.issue.number }}
          body: >-
            Jest tests have been initiated (for more information, click
            [here](https://github.com/webiny/webiny-js/actions/runs/${{
            github.run_id }})). :sparkles:
    runs-on: ubuntu-latest
    env:
      NODE_OPTIONS: '--max_old_space_size=4096'
      YARN_ENABLE_IMMUTABLE_INSTALLS: false
  validateWorkflows:
    name: Validate workflows
    steps:
      - uses: actions/setup-node@v4
        with:
          node-version: 22
      - uses: actions/checkout@v4
      - name: Install dependencies
        run: yarn --immutable
      - name: Validate
        run: npx github-actions-wac validate
    needs: checkComment
    runs-on: ubuntu-latest
    env:
      NODE_OPTIONS: '--max_old_space_size=4096'
      YARN_ENABLE_IMMUTABLE_INSTALLS: false
  baseBranch:
    needs: checkComment
    name: Get base branch
    outputs:
      base-branch: ${{ steps.base-branch.outputs.base-branch }}
    steps:
      - uses: actions/setup-node@v4
        with:
          node-version: 22
      - uses: actions/checkout@v4
      - name: Get base branch
        id: base-branch
        env:
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}
        run: >-
          echo "base-branch=$(gh pr view ${{ github.event.issue.number }} --json
          baseRefName -q .baseRefName)" >> $GITHUB_OUTPUT
    runs-on: ubuntu-latest
    env:
      NODE_OPTIONS: '--max_old_space_size=4096'
      YARN_ENABLE_IMMUTABLE_INSTALLS: false
  constants:
    needs: baseBranch
    name: Create constants
    outputs:
      global-cache-key: ${{ steps.global-cache-key.outputs.global-cache-key }}
      run-cache-key: ${{ steps.run-cache-key.outputs.run-cache-key }}
    steps:
      - uses: actions/setup-node@v4
        with:
          node-version: 22
      - name: Create global cache key
        id: global-cache-key
        run: >-
          echo "global-cache-key=${{ needs.baseBranch.outputs.base-branch }}-${{
          runner.os }}-$(/bin/date -u "+%m%d")-${{ vars.RANDOM_CACHE_KEY_SUFFIX
          }}" >> $GITHUB_OUTPUT
      - name: Create workflow run cache key
        id: run-cache-key
        run: >-
          echo "run-cache-key=${{ github.run_id }}-${{ github.run_attempt }}-${{
          vars.RANDOM_CACHE_KEY_SUFFIX }}" >> $GITHUB_OUTPUT
    runs-on: ubuntu-latest
    env:
      NODE_OPTIONS: '--max_old_space_size=4096'
      YARN_ENABLE_IMMUTABLE_INSTALLS: false
  build:
    name: Build
    needs:
      - baseBranch
      - constants
    runs-on: webiny-build-packages
    steps:
      - uses: actions/setup-node@v4
        with:
          node-version: 22
      - uses: actions/checkout@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}
      - name: Checkout Pull Request
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
        run: gh pr checkout ${{ github.event.issue.number }}
        env:
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}
      - uses: actions/cache@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}/.yarn/cache
          key: yarn-${{ runner.os }}-${{ hashFiles('**/yarn.lock') }}
      - uses: actions/cache@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}/.webiny/cached-packages
          key: ${{ needs.constants.outputs.global-cache-key }}
      - name: Install dependencies
        run: yarn --immutable
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
      - name: Build packages
        run: yarn build
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
      - uses: actions/cache@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}/.webiny/cached-packages
          key: ${{ needs.constants.outputs.run-cache-key }}
    env:
      NODE_OPTIONS: '--max_old_space_size=4096'
      YARN_ENABLE_IMMUTABLE_INSTALLS: false
  jestTestsNoStorage:
    needs:
      - constants
      - build
    name: ${{ matrix.package.cmd }}
    strategy:
      fail-fast: false
      matrix:
        os:
          - ubuntu-latest
        node:
          - 22
        package: >-
          ${{
          fromJson('[{"id":"7923e089671a9127f01e0a27364b9db0","name":"admin-ui"},{"id":"91684628add04a28fed14e33bad3e458","name":"api"},{"id":"f72248ad120cd33f50c83699ef478532","name":"api-aco"},{"id":"dc920d39f3b8b5ce0d6f7145e7876f4d","name":"api-admin-settings"},{"id":"87bb0a10c2848948cad8ade859c2ebc2","name":"api-audit-logs"},{"id":"b1d968e73bca90d1fddf5b138830a0b9","name":"api-authentication"},{"id":"34914cd9a2cd688efc6c760c1e5d3b21","name":"api-authentication-cognito"},{"id":"f7d5f231f8fd2aa109c0530728aaa775","name":"api-dynamodb-to-elasticsearch"},{"id":"b5a6b896831906cc8999ad538bb2bb94","name":"api-elasticsearch"},{"id":"ca5b843cfab211fd37dbd3faee2d0e64","name":"api-elasticsearch-tasks"},{"id":"ff0fce2e7a1281f4f14e678d68ad3ac9","name":"api-file-manager"},{"id":"87c0546e15cfe0e1b64caaba66d88c26","name":"api-file-manager-aco"},{"id":"0e394179a59547f72dab1502da3fb0e0","name":"api-file-manager-s3"},{"id":"498b745a79a7e4790736040bd61931e7","name":"api-headless-cms"},{"id":"a22dd8fefa9225593b6172f7060e2a63","name":"api-headless-cms-aco"},{"id":"7ffe7e3278a34afc3013f40878020238","name":"api-headless-cms-bulk-actions"},{"id":"4263e07f4159291f453ff28e277fc4a5","name":"api-headless-cms-ddb"},{"id":"dbba2651b50bdbcaf57a566a9b34b1cb","name":"api-headless-cms-ddb-es"},{"id":"3a16f3efa9c8a5e7403826e50bc60e43","name":"api-headless-cms-es-tasks"},{"id":"a8cb3313d9b4aed74d22eaba7ab46db1","name":"api-headless-cms-import-export"},{"id":"db03cf01147477bb9a5f17fc1e49c647","name":"api-headless-cms-scheduler"},{"id":"74b080567730a4ba0836cab1c0c7e822","name":"api-headless-cms-tasks"},{"id":"264d43740bf360efc70bf73675a80ea3","name":"api-i18n"},{"id":"10456d4c9d43fea222096507580a8521","name":"api-log"},{"id":"f82fb23e8e94ba22d9af8a2c4eb8bf59","name":"api-mailer"},{"id":"ffc1670731d168f605d0c903d3c2788a","name":"api-record-locking"},{"id":"8a928b2ed8640c484749c174dbd20e10","name":"api-security"},{"id":"048347a24294dd111e3a052adcf25565","name":"api-security-cognito"},{"id":"f08ed3afd17aa0217bccbccfe36b7a0d","name":"api-sync-system"},{"id":"9ace1c3f2f93bd31afbe865731f3e1ee","name":"api-tenancy"},{"id":"4190a21c53894538306be1514c7b021c","name":"api-tenant-manager"},{"id":"5f64114d911187a0e4b3dd2daaeb680f","name":"api-wcp"},{"id":"b4a3dd9274665445bc7a327e399bb7b8","name":"api-websockets"},{"id":"1afc355ada16a237efe8fa0cd4f44f84","name":"app-aco"},{"id":"79fda1b7091e86bea3f8971398b5a6c2","name":"app-admin"},{"id":"cdae701bba7721d4ba156130d7a3643a","name":"app-file-manager"},{"id":"9b99cd31a0a73367bdf69e60fe02cee6","name":"app-headless-cms"},{"id":"49f6b77402fb963980f71c7ed170be35","name":"app-trash-bin"},{"id":"4c241400d6ba4f5b55c502cdd83fd1c1","name":"app-website-builder"},{"id":"300d04ad4d56d8626e705b41a8692865","name":"data-migration"},{"id":"f041789b2f68ce963fa0e99d6521b19b","name":"db-dynamodb"},{"id":"51da862a749befdee46f173a208293e6","name":"di-container"},{"id":"b8147b4049d9d7480988efa97b05b838","name":"form"},{"id":"4e7e021b12f17570b4b63273ef45f2bb","name":"handler"},{"id":"1047aa089caf508da16bbea2cfc78af0","name":"handler-aws"},{"id":"634cf16aded507e9e2b7eb06ab385857","name":"handler-graphql"},{"id":"048bbf6f8afc4e0cd6d3615e2bb754f1","name":"ioc"},{"id":"7a03bfa392e2ae8d3d42b20481ef4107","name":"lexical-converter"},{"id":"523938f8a515402a1630399ebd47b16d","name":"migrations"},{"id":"5c9c463d9d796b817f503954f22fd052","name":"plugins"},{"id":"c807fd8bb895f033e23420c35fbcf495","name":"pubsub"},{"id":"1c6c42679dac867269ec3a3885416886","name":"react-composition"},{"id":"98307650d91f3ea954264087b0f47714","name":"react-properties"},{"id":"76996eb5c9bbf27568f03c43fa43444a","name":"react-rich-text-lexical-renderer"},{"id":"632e1beb8852a95316e9ad45a3c1c63a","name":"react-router"},{"id":"4fdec5968a850ac20b033725aa684fcc","name":"tasks"},{"id":"98cb8a0eb7a5a30669e9fdb10d4e07db","name":"utils"},{"id":"7bdd4ed13cbbf9e8e52502035a4d6d6d","name":"validation"},{"id":"4d2598eac10f892bcda2dd2e89c61719","name":"website-builder-sdk"}]')
          }}
    runs-on: ${{ matrix.os }}
    env:
      NODE_OPTIONS: '--max_old_space_size=4096'
      YARN_ENABLE_IMMUTABLE_INSTALLS: false
      AWS_REGION: eu-central-1
    steps:
      - uses: actions/setup-node@v4
        with:
          node-version: 22
      - uses: actions/checkout@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}
      - uses: actions/cache@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}/.yarn/cache
          key: yarn-${{ runner.os }}-${{ hashFiles('**/yarn.lock') }}
      - uses: actions/cache@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}/.webiny/cached-packages
          key: ${{ needs.constants.outputs.run-cache-key }}
      - name: Install dependencies
        run: yarn --immutable
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
      - name: Build packages
        run: yarn build
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
      - name: Run tests
        run: yarn test ${{ matrix.package.cmd }}
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
  jestTestsDdb:
    needs:
      - constants
      - build
    name: ${{ matrix.package.cmd }}
    strategy:
      fail-fast: false
      matrix:
        os:
          - ubuntu-latest
        node:
          - 22
        package: >-
          ${{
          fromJson('[{"id":"7923e089671a9127f01e0a27364b9db0","name":"admin-ui"},{"id":"91684628add04a28fed14e33bad3e458","name":"api"},{"id":"f72248ad120cd33f50c83699ef478532","name":"api-aco"},{"id":"dc920d39f3b8b5ce0d6f7145e7876f4d","name":"api-admin-settings"},{"id":"87bb0a10c2848948cad8ade859c2ebc2","name":"api-audit-logs"},{"id":"b1d968e73bca90d1fddf5b138830a0b9","name":"api-authentication"},{"id":"34914cd9a2cd688efc6c760c1e5d3b21","name":"api-authentication-cognito"},{"id":"f7d5f231f8fd2aa109c0530728aaa775","name":"api-dynamodb-to-elasticsearch"},{"id":"b5a6b896831906cc8999ad538bb2bb94","name":"api-elasticsearch"},{"id":"ca5b843cfab211fd37dbd3faee2d0e64","name":"api-elasticsearch-tasks"},{"id":"ff0fce2e7a1281f4f14e678d68ad3ac9","name":"api-file-manager"},{"id":"87c0546e15cfe0e1b64caaba66d88c26","name":"api-file-manager-aco"},{"id":"0e394179a59547f72dab1502da3fb0e0","name":"api-file-manager-s3"},{"id":"498b745a79a7e4790736040bd61931e7","name":"api-headless-cms"},{"id":"a22dd8fefa9225593b6172f7060e2a63","name":"api-headless-cms-aco"},{"id":"7ffe7e3278a34afc3013f40878020238","name":"api-headless-cms-bulk-actions"},{"id":"4263e07f4159291f453ff28e277fc4a5","name":"api-headless-cms-ddb"},{"id":"dbba2651b50bdbcaf57a566a9b34b1cb","name":"api-headless-cms-ddb-es"},{"id":"3a16f3efa9c8a5e7403826e50bc60e43","name":"api-headless-cms-es-tasks"},{"id":"a8cb3313d9b4aed74d22eaba7ab46db1","name":"api-headless-cms-import-export"},{"id":"db03cf01147477bb9a5f17fc1e49c647","name":"api-headless-cms-scheduler"},{"id":"74b080567730a4ba0836cab1c0c7e822","name":"api-headless-cms-tasks"},{"id":"264d43740bf360efc70bf73675a80ea3","name":"api-i18n"},{"id":"10456d4c9d43fea222096507580a8521","name":"api-log"},{"id":"f82fb23e8e94ba22d9af8a2c4eb8bf59","name":"api-mailer"},{"id":"ffc1670731d168f605d0c903d3c2788a","name":"api-record-locking"},{"id":"8a928b2ed8640c484749c174dbd20e10","name":"api-security"},{"id":"048347a24294dd111e3a052adcf25565","name":"api-security-cognito"},{"id":"f08ed3afd17aa0217bccbccfe36b7a0d","name":"api-sync-system"},{"id":"9ace1c3f2f93bd31afbe865731f3e1ee","name":"api-tenancy"},{"id":"4190a21c53894538306be1514c7b021c","name":"api-tenant-manager"},{"id":"5f64114d911187a0e4b3dd2daaeb680f","name":"api-wcp"},{"id":"b4a3dd9274665445bc7a327e399bb7b8","name":"api-websockets"},{"id":"1afc355ada16a237efe8fa0cd4f44f84","name":"app-aco"},{"id":"79fda1b7091e86bea3f8971398b5a6c2","name":"app-admin"},{"id":"cdae701bba7721d4ba156130d7a3643a","name":"app-file-manager"},{"id":"9b99cd31a0a73367bdf69e60fe02cee6","name":"app-headless-cms"},{"id":"49f6b77402fb963980f71c7ed170be35","name":"app-trash-bin"},{"id":"4c241400d6ba4f5b55c502cdd83fd1c1","name":"app-website-builder"},{"id":"300d04ad4d56d8626e705b41a8692865","name":"data-migration"},{"id":"f041789b2f68ce963fa0e99d6521b19b","name":"db-dynamodb"},{"id":"51da862a749befdee46f173a208293e6","name":"di-container"},{"id":"b8147b4049d9d7480988efa97b05b838","name":"form"},{"id":"4e7e021b12f17570b4b63273ef45f2bb","name":"handler"},{"id":"1047aa089caf508da16bbea2cfc78af0","name":"handler-aws"},{"id":"634cf16aded507e9e2b7eb06ab385857","name":"handler-graphql"},{"id":"048bbf6f8afc4e0cd6d3615e2bb754f1","name":"ioc"},{"id":"7a03bfa392e2ae8d3d42b20481ef4107","name":"lexical-converter"},{"id":"523938f8a515402a1630399ebd47b16d","name":"migrations"},{"id":"5c9c463d9d796b817f503954f22fd052","name":"plugins"},{"id":"c807fd8bb895f033e23420c35fbcf495","name":"pubsub"},{"id":"1c6c42679dac867269ec3a3885416886","name":"react-composition"},{"id":"98307650d91f3ea954264087b0f47714","name":"react-properties"},{"id":"76996eb5c9bbf27568f03c43fa43444a","name":"react-rich-text-lexical-renderer"},{"id":"632e1beb8852a95316e9ad45a3c1c63a","name":"react-router"},{"id":"4fdec5968a850ac20b033725aa684fcc","name":"tasks"},{"id":"98cb8a0eb7a5a30669e9fdb10d4e07db","name":"utils"},{"id":"7bdd4ed13cbbf9e8e52502035a4d6d6d","name":"validation"},{"id":"4d2598eac10f892bcda2dd2e89c61719","name":"website-builder-sdk"}]')
          }}
    runs-on: ${{ matrix.os }}
    env:
      NODE_OPTIONS: '--max_old_space_size=4096'
      YARN_ENABLE_IMMUTABLE_INSTALLS: false
      AWS_REGION: eu-central-1
    steps:
      - uses: actions/setup-node@v4
        with:
          node-version: 22
      - uses: actions/checkout@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}
      - uses: actions/cache@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}/.yarn/cache
          key: yarn-${{ runner.os }}-${{ hashFiles('**/yarn.lock') }}
      - uses: actions/cache@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}/.webiny/cached-packages
          key: ${{ needs.constants.outputs.run-cache-key }}
      - name: Install dependencies
        run: yarn --immutable
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
      - name: Build packages
        run: yarn build
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
      - name: Run tests
        run: yarn test ${{ matrix.package.cmd }}
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
  jestTestsDdbEs:
    needs:
      - constants
      - build
    name: ${{ matrix.package.cmd }}
    strategy:
      fail-fast: false
      matrix:
        os:
          - ubuntu-latest
        node:
          - 22
        package: >-
          ${{
          fromJson('[{"id":"7923e089671a9127f01e0a27364b9db0","name":"admin-ui"},{"id":"91684628add04a28fed14e33bad3e458","name":"api"},{"id":"f72248ad120cd33f50c83699ef478532","name":"api-aco"},{"id":"dc920d39f3b8b5ce0d6f7145e7876f4d","name":"api-admin-settings"},{"id":"87bb0a10c2848948cad8ade859c2ebc2","name":"api-audit-logs"},{"id":"b1d968e73bca90d1fddf5b138830a0b9","name":"api-authentication"},{"id":"34914cd9a2cd688efc6c760c1e5d3b21","name":"api-authentication-cognito"},{"id":"f7d5f231f8fd2aa109c0530728aaa775","name":"api-dynamodb-to-elasticsearch"},{"id":"b5a6b896831906cc8999ad538bb2bb94","name":"api-elasticsearch"},{"id":"ca5b843cfab211fd37dbd3faee2d0e64","name":"api-elasticsearch-tasks"},{"id":"ff0fce2e7a1281f4f14e678d68ad3ac9","name":"api-file-manager"},{"id":"87c0546e15cfe0e1b64caaba66d88c26","name":"api-file-manager-aco"},{"id":"0e394179a59547f72dab1502da3fb0e0","name":"api-file-manager-s3"},{"id":"498b745a79a7e4790736040bd61931e7","name":"api-headless-cms"},{"id":"a22dd8fefa9225593b6172f7060e2a63","name":"api-headless-cms-aco"},{"id":"7ffe7e3278a34afc3013f40878020238","name":"api-headless-cms-bulk-actions"},{"id":"4263e07f4159291f453ff28e277fc4a5","name":"api-headless-cms-ddb"},{"id":"dbba2651b50bdbcaf57a566a9b34b1cb","name":"api-headless-cms-ddb-es"},{"id":"3a16f3efa9c8a5e7403826e50bc60e43","name":"api-headless-cms-es-tasks"},{"id":"a8cb3313d9b4aed74d22eaba7ab46db1","name":"api-headless-cms-import-export"},{"id":"db03cf01147477bb9a5f17fc1e49c647","name":"api-headless-cms-scheduler"},{"id":"74b080567730a4ba0836cab1c0c7e822","name":"api-headless-cms-tasks"},{"id":"264d43740bf360efc70bf73675a80ea3","name":"api-i18n"},{"id":"10456d4c9d43fea222096507580a8521","name":"api-log"},{"id":"f82fb23e8e94ba22d9af8a2c4eb8bf59","name":"api-mailer"},{"id":"ffc1670731d168f605d0c903d3c2788a","name":"api-record-locking"},{"id":"8a928b2ed8640c484749c174dbd20e10","name":"api-security"},{"id":"048347a24294dd111e3a052adcf25565","name":"api-security-cognito"},{"id":"f08ed3afd17aa0217bccbccfe36b7a0d","name":"api-sync-system"},{"id":"9ace1c3f2f93bd31afbe865731f3e1ee","name":"api-tenancy"},{"id":"4190a21c53894538306be1514c7b021c","name":"api-tenant-manager"},{"id":"5f64114d911187a0e4b3dd2daaeb680f","name":"api-wcp"},{"id":"b4a3dd9274665445bc7a327e399bb7b8","name":"api-websockets"},{"id":"1afc355ada16a237efe8fa0cd4f44f84","name":"app-aco"},{"id":"79fda1b7091e86bea3f8971398b5a6c2","name":"app-admin"},{"id":"cdae701bba7721d4ba156130d7a3643a","name":"app-file-manager"},{"id":"9b99cd31a0a73367bdf69e60fe02cee6","name":"app-headless-cms"},{"id":"49f6b77402fb963980f71c7ed170be35","name":"app-trash-bin"},{"id":"4c241400d6ba4f5b55c502cdd83fd1c1","name":"app-website-builder"},{"id":"300d04ad4d56d8626e705b41a8692865","name":"data-migration"},{"id":"f041789b2f68ce963fa0e99d6521b19b","name":"db-dynamodb"},{"id":"51da862a749befdee46f173a208293e6","name":"di-container"},{"id":"b8147b4049d9d7480988efa97b05b838","name":"form"},{"id":"4e7e021b12f17570b4b63273ef45f2bb","name":"handler"},{"id":"1047aa089caf508da16bbea2cfc78af0","name":"handler-aws"},{"id":"634cf16aded507e9e2b7eb06ab385857","name":"handler-graphql"},{"id":"048bbf6f8afc4e0cd6d3615e2bb754f1","name":"ioc"},{"id":"7a03bfa392e2ae8d3d42b20481ef4107","name":"lexical-converter"},{"id":"523938f8a515402a1630399ebd47b16d","name":"migrations"},{"id":"5c9c463d9d796b817f503954f22fd052","name":"plugins"},{"id":"c807fd8bb895f033e23420c35fbcf495","name":"pubsub"},{"id":"1c6c42679dac867269ec3a3885416886","name":"react-composition"},{"id":"98307650d91f3ea954264087b0f47714","name":"react-properties"},{"id":"76996eb5c9bbf27568f03c43fa43444a","name":"react-rich-text-lexical-renderer"},{"id":"632e1beb8852a95316e9ad45a3c1c63a","name":"react-router"},{"id":"4fdec5968a850ac20b033725aa684fcc","name":"tasks"},{"id":"98cb8a0eb7a5a30669e9fdb10d4e07db","name":"utils"},{"id":"7bdd4ed13cbbf9e8e52502035a4d6d6d","name":"validation"},{"id":"4d2598eac10f892bcda2dd2e89c61719","name":"website-builder-sdk"}]')
          }}
    runs-on: ${{ matrix.os }}
    env:
      NODE_OPTIONS: '--max_old_space_size=4096'
      YARN_ENABLE_IMMUTABLE_INSTALLS: false
      AWS_REGION: eu-central-1
      AWS_ELASTIC_SEARCH_DOMAIN_NAME: ${{ secrets.AWS_ELASTIC_SEARCH_DOMAIN_NAME }}
      ELASTIC_SEARCH_ENDPOINT: ${{ secrets.ELASTIC_SEARCH_ENDPOINT }}
      ELASTIC_SEARCH_INDEX_PREFIX: ${{ matrix.package.id }}
    steps:
      - uses: actions/setup-node@v4
        with:
          node-version: 22
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v4
        with:
          role-to-assume: arn:aws:iam::726952677045:role/GitHubActionsWebinyJs
          aws-region: eu-central-1
      - uses: actions/checkout@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}
      - uses: actions/cache@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}/.yarn/cache
          key: yarn-${{ runner.os }}-${{ hashFiles('**/yarn.lock') }}
      - uses: actions/cache@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}/.webiny/cached-packages
          key: ${{ needs.constants.outputs.run-cache-key }}
      - name: Install dependencies
        run: yarn --immutable
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
      - name: Build packages
        run: yarn build
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
      - name: Run tests
        run: yarn test ${{ matrix.package.cmd }}
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
    permissions:
      id-token: write
  jestTestsDdbOs:
    needs:
      - constants
      - build
    name: ${{ matrix.package.cmd }}
    strategy:
      fail-fast: false
      matrix:
        os:
          - ubuntu-latest
        node:
          - 22
        package: >-
          ${{
          fromJson('[{"id":"7923e089671a9127f01e0a27364b9db0","name":"admin-ui"},{"id":"91684628add04a28fed14e33bad3e458","name":"api"},{"id":"f72248ad120cd33f50c83699ef478532","name":"api-aco"},{"id":"dc920d39f3b8b5ce0d6f7145e7876f4d","name":"api-admin-settings"},{"id":"87bb0a10c2848948cad8ade859c2ebc2","name":"api-audit-logs"},{"id":"b1d968e73bca90d1fddf5b138830a0b9","name":"api-authentication"},{"id":"34914cd9a2cd688efc6c760c1e5d3b21","name":"api-authentication-cognito"},{"id":"f7d5f231f8fd2aa109c0530728aaa775","name":"api-dynamodb-to-elasticsearch"},{"id":"b5a6b896831906cc8999ad538bb2bb94","name":"api-elasticsearch"},{"id":"ca5b843cfab211fd37dbd3faee2d0e64","name":"api-elasticsearch-tasks"},{"id":"ff0fce2e7a1281f4f14e678d68ad3ac9","name":"api-file-manager"},{"id":"87c0546e15cfe0e1b64caaba66d88c26","name":"api-file-manager-aco"},{"id":"0e394179a59547f72dab1502da3fb0e0","name":"api-file-manager-s3"},{"id":"498b745a79a7e4790736040bd61931e7","name":"api-headless-cms"},{"id":"a22dd8fefa9225593b6172f7060e2a63","name":"api-headless-cms-aco"},{"id":"7ffe7e3278a34afc3013f40878020238","name":"api-headless-cms-bulk-actions"},{"id":"4263e07f4159291f453ff28e277fc4a5","name":"api-headless-cms-ddb"},{"id":"dbba2651b50bdbcaf57a566a9b34b1cb","name":"api-headless-cms-ddb-es"},{"id":"3a16f3efa9c8a5e7403826e50bc60e43","name":"api-headless-cms-es-tasks"},{"id":"a8cb3313d9b4aed74d22eaba7ab46db1","name":"api-headless-cms-import-export"},{"id":"db03cf01147477bb9a5f17fc1e49c647","name":"api-headless-cms-scheduler"},{"id":"74b080567730a4ba0836cab1c0c7e822","name":"api-headless-cms-tasks"},{"id":"264d43740bf360efc70bf73675a80ea3","name":"api-i18n"},{"id":"10456d4c9d43fea222096507580a8521","name":"api-log"},{"id":"f82fb23e8e94ba22d9af8a2c4eb8bf59","name":"api-mailer"},{"id":"ffc1670731d168f605d0c903d3c2788a","name":"api-record-locking"},{"id":"8a928b2ed8640c484749c174dbd20e10","name":"api-security"},{"id":"048347a24294dd111e3a052adcf25565","name":"api-security-cognito"},{"id":"f08ed3afd17aa0217bccbccfe36b7a0d","name":"api-sync-system"},{"id":"9ace1c3f2f93bd31afbe865731f3e1ee","name":"api-tenancy"},{"id":"4190a21c53894538306be1514c7b021c","name":"api-tenant-manager"},{"id":"5f64114d911187a0e4b3dd2daaeb680f","name":"api-wcp"},{"id":"b4a3dd9274665445bc7a327e399bb7b8","name":"api-websockets"},{"id":"1afc355ada16a237efe8fa0cd4f44f84","name":"app-aco"},{"id":"79fda1b7091e86bea3f8971398b5a6c2","name":"app-admin"},{"id":"cdae701bba7721d4ba156130d7a3643a","name":"app-file-manager"},{"id":"9b99cd31a0a73367bdf69e60fe02cee6","name":"app-headless-cms"},{"id":"49f6b77402fb963980f71c7ed170be35","name":"app-trash-bin"},{"id":"4c241400d6ba4f5b55c502cdd83fd1c1","name":"app-website-builder"},{"id":"300d04ad4d56d8626e705b41a8692865","name":"data-migration"},{"id":"f041789b2f68ce963fa0e99d6521b19b","name":"db-dynamodb"},{"id":"51da862a749befdee46f173a208293e6","name":"di-container"},{"id":"b8147b4049d9d7480988efa97b05b838","name":"form"},{"id":"4e7e021b12f17570b4b63273ef45f2bb","name":"handler"},{"id":"1047aa089caf508da16bbea2cfc78af0","name":"handler-aws"},{"id":"634cf16aded507e9e2b7eb06ab385857","name":"handler-graphql"},{"id":"048bbf6f8afc4e0cd6d3615e2bb754f1","name":"ioc"},{"id":"7a03bfa392e2ae8d3d42b20481ef4107","name":"lexical-converter"},{"id":"523938f8a515402a1630399ebd47b16d","name":"migrations"},{"id":"5c9c463d9d796b817f503954f22fd052","name":"plugins"},{"id":"c807fd8bb895f033e23420c35fbcf495","name":"pubsub"},{"id":"1c6c42679dac867269ec3a3885416886","name":"react-composition"},{"id":"98307650d91f3ea954264087b0f47714","name":"react-properties"},{"id":"76996eb5c9bbf27568f03c43fa43444a","name":"react-rich-text-lexical-renderer"},{"id":"632e1beb8852a95316e9ad45a3c1c63a","name":"react-router"},{"id":"4fdec5968a850ac20b033725aa684fcc","name":"tasks"},{"id":"98cb8a0eb7a5a30669e9fdb10d4e07db","name":"utils"},{"id":"7bdd4ed13cbbf9e8e52502035a4d6d6d","name":"validation"},{"id":"4d2598eac10f892bcda2dd2e89c61719","name":"website-builder-sdk"}]')
          }}
    runs-on: ${{ matrix.os }}
    env:
      NODE_OPTIONS: '--max_old_space_size=4096'
      YARN_ENABLE_IMMUTABLE_INSTALLS: false
      AWS_REGION: eu-central-1
      AWS_ELASTIC_SEARCH_DOMAIN_NAME: ${{ secrets.AWS_OPEN_SEARCH_DOMAIN_NAME }}
      ELASTIC_SEARCH_ENDPOINT: ${{ secrets.OPEN_SEARCH_ENDPOINT }}
      ELASTIC_SEARCH_INDEX_PREFIX: ${{ matrix.package.id }}
    steps:
      - uses: actions/setup-node@v4
        with:
          node-version: 22
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v4
        with:
          role-to-assume: arn:aws:iam::726952677045:role/GitHubActionsWebinyJs
          aws-region: eu-central-1
      - uses: actions/checkout@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}
      - uses: actions/cache@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}/.yarn/cache
          key: yarn-${{ runner.os }}-${{ hashFiles('**/yarn.lock') }}
      - uses: actions/cache@v4
        with:
          path: ${{ needs.baseBranch.outputs.base-branch }}/.webiny/cached-packages
          key: ${{ needs.constants.outputs.run-cache-key }}
      - name: Install dependencies
        run: yarn --immutable
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
      - name: Build packages
        run: yarn build
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
      - name: Run tests
        run: yarn test ${{ matrix.package.cmd }}
        working-directory: ${{ needs.baseBranch.outputs.base-branch }}
    permissions:
      id-token: write
